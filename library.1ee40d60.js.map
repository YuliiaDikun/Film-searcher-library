{"mappings":"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","sources":["src/js/library.js","src/templates/filmLibraryCard.hbs"],"sourcesContent":["import Notiflix from 'notiflix';\nimport FilmApi from './movieAPI';\nimport filmCard from '../templates/modal-film.hbs';\nimport fixObject from './fixObject';\nimport { setLocalStorage, getLocalStorage } from './localStorage';\nimport filmLibraryCard from '../templates/filmLibraryCard.hbs';\nimport setFilmToLocalStorage from './setFilmToLocalStorage';\nimport './theme';\nimport './topBtn';\n\nconst watchedLibraryBtn = document.querySelector('[data-watched]');\nconst queueLibraryBtn = document.querySelector('[data-queue]');\nconst ulEl = document.querySelector('.films');\n\nconst LOCAL_WATCHED = 'watchedList';\nconst LOCAL_QUEUE = 'queueList';\nconst LOCAL_LIST = 'selectedList';\n\nwatchedLibraryBtn.addEventListener('click', onWatchedLibrary);\nqueueLibraryBtn.addEventListener('click', onQueueLibrary);\nulEl.addEventListener('click', onUlElClick);\n\nconst filmAPIByID = new FilmApi();\n\nfunction onWatchedLibrary() {\n  queueLibraryBtn.classList.remove('is-active');\n  watchedLibraryBtn.classList.add('is-active');\n\n  createFilmList(LOCAL_WATCHED);\n  setLocalStorage(LOCAL_LIST, 'watched');\n}\n\nfunction onQueueLibrary() {\n  watchedLibraryBtn.classList.remove('is-active');\n  queueLibraryBtn.classList.add('is-active');\n\n  createFilmList(LOCAL_QUEUE);\n  setLocalStorage(LOCAL_LIST, 'queue');\n}\n\nasync function onUlElClick(e) {\n  try {\n    if (e.target.nodeName === 'UL') {\n      return;\n    }\n    const selectedList = getLocalStorage(LOCAL_LIST);\n\n    const item = e.target.closest('li');\n\n    let id = item.dataset.id;\n\n    filmAPIByID.idFilm = id;\n    const film = await filmAPIByID.getFilmByID();\n\n    const fixedFilm = fixObject(film);\n    const filmMarkUp = filmCard(fixedFilm);\n\n    document.querySelector('body').insertAdjacentHTML('beforeend', filmMarkUp);\n    let modal = document.querySelector('.modal-backdrop');\n    let watchedBtn = document.querySelector('[data-name=\"watched\"]');\n    let queueBtn = document.querySelector('[data-name=\"queue\"]');\n    watchedBtn.textContent = 'REMOVE';\n    if (selectedList === 'queue') {\n      queueBtn.textContent = 'ADD TO WATCHED';\n    }\n    const onClose = event => {\n      if (event.code === 'Escape') {\n        modal.remove();\n        document.removeEventListener('keydown', onClose);\n      }\n    };\n    const onModalFilmClick = event => {\n      if (event.target.nodeName === 'path' || event.target.nodeName === 'svg') {\n        modal.remove();\n        document.removeEventListener('keydown', onClose);\n      }\n      if (event.target === event.currentTarget) {\n        modal.remove();\n        document.removeEventListener('keydown', onClose);\n      }\n    };\n    const onWatchedBtn = event => {\n      if (selectedList === 'watched') {\n        removeFromLocal(LOCAL_WATCHED, id, item, modal);\n      } else {\n        removeFromLocal(LOCAL_QUEUE, id, item, modal);\n      }\n    };\n    const onQueueBtn = event => {\n      if (selectedList === 'queue') {\n        setFilmToLocalStorage(LOCAL_WATCHED, id, fixedFilm, onClose);\n        removeFromLocal(LOCAL_QUEUE, id, item, modal);\n      } else {\n        setFilmToLocalStorage(LOCAL_QUEUE, id, fixedFilm, onClose);\n        removeFromLocal(LOCAL_WATCHED, id, item, modal);\n      }\n    };\n    modal.addEventListener('click', onModalFilmClick);\n    document.addEventListener('keydown', onClose);\n    watchedBtn.addEventListener('click', onWatchedBtn);\n    queueBtn.addEventListener('click', onQueueBtn);\n  } catch (error) {\n    Notiflix.Notify.failure(error.message);\n  }\n}\n\nfunction removeFromLocal(localKey, filmId, li, modal, onClose) {\n  const watchedArray = getLocalStorage(localKey);\n  const index = watchedArray.findIndex(film => film.id === Number(filmId));\n  watchedArray.splice(index, 1);\n  setLocalStorage(localKey, watchedArray);\n  li.remove();\n  modal.remove();\n  document.removeEventListener('keydown', onClose);\n}\n\nfunction createFilmList(localKey) {\n  ulEl.innerHTML = '';\n  const arrayOfWatchedFilms = getLocalStorage(localKey);\n  if (!arrayOfWatchedFilms.length) {\n    Notiflix.Notify.failure('The list is empty.');\n  }\n  const watchedMarkUp = arrayOfWatchedFilms\n    .map(film => filmLibraryCard(film))\n    .join('');\n  ulEl.insertAdjacentHTML('beforeend', watchedMarkUp);\n}\n","<li class='films__item' data-id={{id}}>\n    <div class='films__img'>\n        <img src='https://image.tmdb.org/t/p/w500{{poster_path}}' alt={{original_title}} loading='lazy' />\n    </div>\n    <div class='films__description'>\n        <p class='films__name'>{{title}}</p>\n        <div class=\"films__container\">\n            <p class='films__info'>{{genres}} | {{release_date}}</p>\n            <span class='films__rating'>{{vote_average}}</span>\n        </div>      \n    </div>\n</li>"],"names":["$eWCmQ","parcelRequire","$9fc7fd4e44c7ad3b$export$2e2bcd8739ae039","$parcel$interopDefault","template","compiler","main","container","depth0","helpers","partials","data","helper","alias1","nullContext","alias2","hooks","helperMissing","alias3","alias4","escapeExpression","lookupProperty","parent","propertyName","Object","prototype","hasOwnProperty","call","name","hash","loc","start","line","column","end","useData","$1cafa503bc57b7a0$var$watchedLibraryBtn","document","querySelector","$1cafa503bc57b7a0$var$queueLibraryBtn","$1cafa503bc57b7a0$var$ulEl","addEventListener","classList","remove","add","$1cafa503bc57b7a0$var$createFilmList","$31u3U","setLocalStorage","async","e","target","nodeName","selectedList","getLocalStorage","item","closest","id","dataset","$1cafa503bc57b7a0$var$filmAPIByID","idFilm","film","getFilmByID","fixedFilm","$6Jpgb","default","filmMarkUp","$eXQeU","insertAdjacentHTML","modal","watchedBtn","queueBtn","textContent","onClose","event","code","removeEventListener","onModalFilmClick","currentTarget","onWatchedBtn","$1cafa503bc57b7a0$var$removeFromLocal","onQueueBtn","$2ST4D","error","Notify","failure","message","$9Bkxl","localKey","filmId","li","watchedArray","index","findIndex","Number","splice","innerHTML","arrayOfWatchedFilms","length","watchedMarkUp","map","join"],"version":3,"file":"library.1ee40d60.js.map"}