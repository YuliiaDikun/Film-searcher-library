{"mappings":"qhBAAA,IAAAA,EAAAC,EAAA,S,wDC0BIC,EAxByBC,EADzBF,EAAA,UACoCG,SAAS,CAACC,SAAW,CAAC,EAAE,YAAYC,KAAO,SAASC,EAAUC,EAAOC,EAAQC,EAASC,GAC1H,IAAIC,EAAQC,EAAiB,MAAVL,EAAiBA,EAAUD,EAAUO,aAAe,GAAKC,EAAOR,EAAUS,MAAMC,cAAeC,EAAO,WAAYC,EAAOZ,EAAUa,iBAAkBC,EAAiBd,EAAUc,gBAAkB,SAASC,EAAQC,GAClO,GAAIC,OAAOC,UAAUC,eAAeC,KAAKL,EAAQC,GAC/C,OAAOD,EAAOC,E,EAKtB,MAAO,mCACHJ,SAAQP,EAAgH,OAArGA,EAASS,EAAeZ,EAAQ,QAAoB,MAAVD,EAAiBa,EAAeb,EAAO,MAAQA,IAAmBI,EAASG,KAA2BG,EAASN,EAAOe,KAAKd,EAAO,CAACe,KAAO,KAAKC,KAAO,GAAGlB,KAAOA,EAAKmB,IAAM,CAACC,MAAQ,CAACC,KAAO,EAAEC,OAAS,IAAIC,IAAM,CAACF,KAAO,EAAEC,OAAS,OAASrB,GAC1S,qFACAO,SAAQP,EAAkI,OAAvHA,EAASS,EAAeZ,EAAQ,iBAA6B,MAAVD,EAAiBa,EAAeb,EAAO,eAAiBA,IAAmBI,EAASG,KAA2BG,EAASN,EAAOe,KAAKd,EAAO,CAACe,KAAO,cAAcC,KAAO,GAAGlB,KAAOA,EAAKmB,IAAM,CAACC,MAAQ,CAACC,KAAO,EAAEC,OAAS,IAAIC,IAAM,CAACF,KAAO,EAAEC,OAAS,OAASrB,GACrU,SACAO,SAAQP,EAAwI,OAA7HA,EAASS,EAAeZ,EAAQ,oBAAgC,MAAVD,EAAiBa,EAAeb,EAAO,kBAAoBA,IAAmBI,EAASG,KAA2BG,EAASN,EAAOe,KAAKd,EAAO,CAACe,KAAO,iBAAiBC,KAAO,GAAGlB,KAAOA,EAAKmB,IAAM,CAACC,MAAQ,CAACC,KAAO,EAAEC,OAAS,IAAIC,IAAM,CAACF,KAAO,EAAEC,OAAS,OAASrB,GAC9U,wGACAO,SAAQP,EAAsH,OAA3GA,EAASS,EAAeZ,EAAQ,WAAuB,MAAVD,EAAiBa,EAAeb,EAAO,SAAWA,IAAmBI,EAASG,KAA2BG,EAASN,EAAOe,KAAKd,EAAO,CAACe,KAAO,QAAQC,KAAO,GAAGlB,KAAOA,EAAKmB,IAAM,CAACC,MAAQ,CAACC,KAAO,EAAEC,OAAS,IAAIC,IAAM,CAACF,KAAO,EAAEC,OAAS,OAASrB,GACnT,sFACAO,SAAQP,EAAwH,OAA7GA,EAASS,EAAeZ,EAAQ,YAAwB,MAAVD,EAAiBa,EAAeb,EAAO,UAAYA,IAAmBI,EAASG,KAA2BG,EAASN,EAAOe,KAAKd,EAAO,CAACe,KAAO,SAASC,KAAO,GAAGlB,KAAOA,EAAKmB,IAAM,CAACC,MAAQ,CAACC,KAAO,EAAEC,OAAS,IAAIC,IAAM,CAACF,KAAO,EAAEC,OAAS,OAASrB,GACtT,MACAO,SAAQP,EAAoI,OAAzHA,EAASS,EAAeZ,EAAQ,kBAA8B,MAAVD,EAAiBa,EAAeb,EAAO,gBAAkBA,IAAmBI,EAASG,KAA2BG,EAASN,EAAOe,KAAKd,EAAO,CAACe,KAAO,eAAeC,KAAO,GAAGlB,KAAOA,EAAKmB,IAAM,CAACC,MAAQ,CAACC,KAAO,EAAEC,OAAS,IAAIC,IAAM,CAACF,KAAO,EAAEC,OAAS,OAASrB,GACxU,iDACAO,SAAQP,EAAoI,OAAzHA,EAASS,EAAeZ,EAAQ,kBAA8B,MAAVD,EAAiBa,EAAeb,EAAO,gBAAkBA,IAAmBI,EAASG,KAA2BG,EAASN,EAAOe,KAAKd,EAAO,CAACe,KAAO,eAAeC,KAAO,GAAGlB,KAAOA,EAAKmB,IAAM,CAACC,MAAQ,CAACC,KAAO,EAAEC,OAAS,IAAIC,IAAM,CAACF,KAAO,EAAEC,OAAS,OAASrB,GACxU,kD,EACJuB,SAAU,I,mCDfZ,MAAMC,EAAoBC,SAASC,cAAc,kBAC3CC,EAAkBF,SAASC,cAAc,gBACzCE,EAAOH,SAASC,cAAc,UAC9BG,EAAiBJ,SAASC,cAAc,kBAM9CF,EAAkBM,iBAAiB,SAMnC,WACEH,EAAgBI,UAAUC,OAAO,aACjCR,EAAkBO,UAAUE,IAAI,aAEhCC,EAdoB,gBAepB,EAAAC,EAAAC,iBAbiB,eAaW,U,IAV9BT,EAAgBG,iBAAiB,SAajC,WACEN,EAAkBO,UAAUC,OAAO,aACnCL,EAAgBI,UAAUE,IAAI,aAE9BC,EArBkB,cAsBlB,EAAAC,EAAAC,iBArBiB,eAqBW,Q,IAjB9BR,EAAKE,iBAAiB,SAoBtBO,eAA2BC,GACzB,IACE,GAA0B,OAAtBA,EAAEC,OAAOC,SACX,OAEF,MAAMC,GAAe,EAAAN,EAAAO,iBA7BN,gBA+BTC,EAAOL,EAAEC,OAAOK,QAAQ,MAE9B,IAAIC,EAAKF,EAAKG,QAAQD,GAEtBE,EAAYC,OAASH,EACrB,MAAMI,QAAaF,EAAYG,cAG/B,IAAIC,SADgBJ,EAAYK,kBAChBC,QAShB,MAAMC,EAAY,iCADkBH,EAL/BI,KAAIC,GACIA,IAERC,MAAKD,GAAkB,qBAAZA,EAAGxC,OAGkD0C,MAE/DC,GAAY,EAAAC,EAAAC,SAAUZ,GAC5BU,EAAUG,MAAQR,EAElB,MAAMS,GAAa,EAAAC,EAAAH,SAASF,GAE5B9B,EAAeoC,UAAYF,EAC3BlC,EAAeE,UAAUC,OAAO,aAChC,IAAIkC,EAAgBzC,SAASC,cAAc,gBACvCyC,EAAY1C,SAASC,cAAc,WACvCwC,EAAcpC,iBAAiB,SAAS,KACtCqC,EAAUpC,UAAUqC,OAAO,mBAAmB,IAGhD,IAAIC,EAAa5C,SAASC,cAAc,yBACpC4C,EAAW7C,SAASC,cAAc,uBACtC2C,EAAWE,YAAc,SACJ,UAAjB9B,IACF6B,EAASC,YAAc,kBAGzB,MAAMC,EAAeC,IAEjBC,EADmB,YAAjBjC,EAzEY,cACF,YAyEmBI,EAAIF,EAEG,EAGpCgC,EAAaF,IACI,UAAjBhC,IACF,EAAAmC,EAAAf,SAjFc,cAiFuBhB,EAAIc,GACzCe,EAjFY,YAiFiB7B,EAAIF,MAEjC,EAAAiC,EAAAf,SAnFY,YAmFuBhB,EAAIc,GACvCe,EArFc,cAqFiB7B,EAAIF,G,EAGvCd,EAAeC,iBAAiB,QAAS+C,GACzCpD,SAASK,iBAAiB,UAAWgD,GACrCT,EAAWvC,iBAAiB,QAAS0C,GACrCF,EAASxC,iBAAiB,QAAS6C,E,CACnC,MAAOI,GACPxF,EAAAH,GAAS4F,OAAOC,QAAQF,EAAMG,Q,KArFlC,MAAMnC,EAAc,IAAI,EAAAoC,EAAAtB,SAyFxB,SAASa,EAAgBU,EAAUC,EAAQC,GACzC,MAAMC,GAAe,EAAApD,EAAAO,iBAAgB0C,GAC/BI,EAAQD,EAAaE,WAAUxC,GAAQA,EAAKJ,KAAO6C,OAAOL,KAChEE,EAAaI,OAAOH,EAAO,IAC3B,EAAArD,EAAAC,iBAAgBgD,EAAUG,GAC1BK,IACAN,EAAGtD,Q,CAGL,SAASE,EAAekD,GACtBxD,EAAKqC,UAAY,GACjB,MAAM4B,GAAsB,EAAA1D,EAAAO,iBAAgB0C,GACvCS,EAAoBC,QACvBvG,EAAAH,GAAS4F,OAAOC,QAAQ,sBAE1B,MAAMc,EAAgBF,EACnBtC,KAAIN,GAAQ3D,EAAgB2D,KAC5B+C,KAAK,IACRpE,EAAKqE,mBAAmB,YAAaF,E,CAEvC,SAASH,IACP/D,EAAeoC,UAAY,GAC3BpC,EAAeE,UAAUE,IAAI,aAC7BR,SAASyE,oBAAoB,UAAWpB,GACxCjD,EAAeqE,oBAAoB,QAASrB,E,CAE9C,SAASC,EAAQL,GACI,WAAfA,EAAM0B,MACRP,G,CAGJ,SAASf,EAAiBJ,GACM,SAA1BA,EAAMlC,OAAOC,UAAiD,QAA1BiC,EAAMlC,OAAOC,UACnDoD,IAEEnB,EAAMlC,SAAWkC,EAAM2B,eACzBR,G","sources":["src/js/library.js","src/templates/filmLibraryCard.hbs"],"sourcesContent":["import Notiflix from 'notiflix';\nimport FilmApi from './movieAPI';\nimport filmCard from '../templates/modal-film.hbs';\nimport fixObject from './fixObject';\nimport { setLocalStorage, getLocalStorage } from './localStorage';\nimport filmLibraryCard from '../templates/filmLibraryCard.hbs';\nimport setFilmToLocalStorage from './setFilmToLocalStorage';\nimport './theme';\nimport './topBtn';\n\nconst watchedLibraryBtn = document.querySelector('[data-watched]');\nconst queueLibraryBtn = document.querySelector('[data-queue]');\nconst ulEl = document.querySelector('.films');\nconst modalContainer = document.querySelector('#js-film-modal');\n\nconst LOCAL_WATCHED = 'watchedList';\nconst LOCAL_QUEUE = 'queueList';\nconst LOCAL_LIST = 'selectedList';\n\nwatchedLibraryBtn.addEventListener('click', onWatchedLibrary);\nqueueLibraryBtn.addEventListener('click', onQueueLibrary);\nulEl.addEventListener('click', onUlElClick);\n\nconst filmAPIByID = new FilmApi();\n\nfunction onWatchedLibrary() {\n  queueLibraryBtn.classList.remove('is-active');\n  watchedLibraryBtn.classList.add('is-active');\n\n  createFilmList(LOCAL_WATCHED);\n  setLocalStorage(LOCAL_LIST, 'watched');\n}\n\nfunction onQueueLibrary() {\n  watchedLibraryBtn.classList.remove('is-active');\n  queueLibraryBtn.classList.add('is-active');\n\n  createFilmList(LOCAL_QUEUE);\n  setLocalStorage(LOCAL_LIST, 'queue');\n}\n\nasync function onUlElClick(e) {\n  try {\n    if (e.target.nodeName === 'UL') {\n      return;\n    }\n    const selectedList = getLocalStorage(LOCAL_LIST);\n\n    const item = e.target.closest('li');\n\n    let id = item.dataset.id;\n\n    filmAPIByID.idFilm = id;\n    const film = await filmAPIByID.getFilmByID();\n\n    const video = await filmAPIByID.getTrailerById();\n    let arr = video.results;\n    function findTrailer(arr) {\n      return arr\n        .map(el => {\n          return el;\n        })\n        .find(el => el.name === 'Official Trailer');\n    }\n    let objectWithTrailer = findTrailer(arr);\n    const movieLink = `https://www.youtube.com/embed/${objectWithTrailer.key}`;\n\n    const fixedFilm = fixObject(film);\n    fixedFilm.movie = movieLink;\n\n    const filmMarkUp = filmCard(fixedFilm);\n\n    modalContainer.innerHTML = filmMarkUp;\n    modalContainer.classList.remove('is-hidden');\n    let trailerBtnRef = document.querySelector('.trailerShow');\n    let iframeRef = document.querySelector('.hidden');\n    trailerBtnRef.addEventListener('click', () => {\n      iframeRef.classList.toggle('trailer__youtube');\n    });\n\n    let watchedBtn = document.querySelector('[data-name=\"watched\"]');\n    let queueBtn = document.querySelector('[data-name=\"queue\"]');\n    watchedBtn.textContent = 'REMOVE';\n    if (selectedList === 'queue') {\n      queueBtn.textContent = 'ADD TO WATCHED';\n    }\n\n    const onWatchedBtn = event => {\n      if (selectedList === 'watched') {\n        removeFromLocal(LOCAL_WATCHED, id, item);\n      } else {\n        removeFromLocal(LOCAL_QUEUE, id, item);\n      }\n    };\n    const onQueueBtn = event => {\n      if (selectedList === 'queue') {\n        setFilmToLocalStorage(LOCAL_WATCHED, id, fixedFilm);\n        removeFromLocal(LOCAL_QUEUE, id, item);\n      } else {\n        setFilmToLocalStorage(LOCAL_QUEUE, id, fixedFilm);\n        removeFromLocal(LOCAL_WATCHED, id, item);\n      }\n    };\n    modalContainer.addEventListener('click', onModalFilmClick);\n    document.addEventListener('keydown', onClose);\n    watchedBtn.addEventListener('click', onWatchedBtn);\n    queueBtn.addEventListener('click', onQueueBtn);\n  } catch (error) {\n    Notiflix.Notify.failure(error.message);\n  }\n}\n\nfunction removeFromLocal(localKey, filmId, li) {\n  const watchedArray = getLocalStorage(localKey);\n  const index = watchedArray.findIndex(film => film.id === Number(filmId));\n  watchedArray.splice(index, 1);\n  setLocalStorage(localKey, watchedArray);\n  closeModal();\n  li.remove();\n}\n\nfunction createFilmList(localKey) {\n  ulEl.innerHTML = '';\n  const arrayOfWatchedFilms = getLocalStorage(localKey);\n  if (!arrayOfWatchedFilms.length) {\n    Notiflix.Notify.failure('The list is empty.');\n  }\n  const watchedMarkUp = arrayOfWatchedFilms\n    .map(film => filmLibraryCard(film))\n    .join('');\n  ulEl.insertAdjacentHTML('beforeend', watchedMarkUp);\n}\nfunction closeModal() {\n  modalContainer.innerHTML = '';\n  modalContainer.classList.add('is-hidden');\n  document.removeEventListener('keydown', onClose);\n  modalContainer.removeEventListener('click', onModalFilmClick);\n}\nfunction onClose(event) {\n  if (event.code === 'Escape') {\n    closeModal();\n  }\n}\nfunction onModalFilmClick(event) {\n  if (event.target.nodeName === 'path' || event.target.nodeName === 'svg') {\n    closeModal();\n  }\n  if (event.target === event.currentTarget) {\n    closeModal();\n  }\n}\n","<li class='films__item' data-id={{id}}>\n    <div class='films__img'>\n        <img src='https://image.tmdb.org/t/p/w500{{poster_path}}' alt={{original_title}} loading='lazy' />\n    </div>\n    <div class='films__description'>\n        <p class='films__name'>{{title}}</p>\n        <div class=\"films__container\">\n            <p class='films__info'>{{genres}} | {{release_date}}</p>\n            <span class='films__rating'>{{vote_average}}</span>\n        </div>      \n    </div>\n</li>"],"names":["$eWCmQ","parcelRequire","$9fc7fd4e44c7ad3b$export$2e2bcd8739ae039","$parcel$interopDefault","template","compiler","main","container","depth0","helpers","partials","data","helper","alias1","nullContext","alias2","hooks","helperMissing","alias3","alias4","escapeExpression","lookupProperty","parent","propertyName","Object","prototype","hasOwnProperty","call","name","hash","loc","start","line","column","end","useData","$1cafa503bc57b7a0$var$watchedLibraryBtn","document","querySelector","$1cafa503bc57b7a0$var$queueLibraryBtn","$1cafa503bc57b7a0$var$ulEl","$1cafa503bc57b7a0$var$modalContainer","addEventListener","classList","remove","add","$1cafa503bc57b7a0$var$createFilmList","$31u3U","setLocalStorage","async","e","target","nodeName","selectedList","getLocalStorage","item","closest","id","dataset","$1cafa503bc57b7a0$var$filmAPIByID","idFilm","film","getFilmByID","arr1","getTrailerById","results","movieLink","map","el","find","key","fixedFilm","$6Jpgb","default","movie","filmMarkUp","$eXQeU","innerHTML","trailerBtnRef","iframeRef","toggle","watchedBtn","queueBtn","textContent","onWatchedBtn","event","$1cafa503bc57b7a0$var$removeFromLocal","onQueueBtn","$2ST4D","$1cafa503bc57b7a0$var$onModalFilmClick","$1cafa503bc57b7a0$var$onClose","error","Notify","failure","message","$9Bkxl","localKey","filmId","li","watchedArray","index","findIndex","Number","splice","$1cafa503bc57b7a0$var$closeModal","arrayOfWatchedFilms","length","watchedMarkUp","join","insertAdjacentHTML","removeEventListener","code","currentTarget"],"version":3,"file":"library.df509e0c.js.map"}