{"mappings":"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","sources":["src/js/library.js","src/templates/filmLibraryCard.hbs"],"sourcesContent":["import Notiflix from 'notiflix';\nimport FilmApi from './movieAPI';\nimport filmCard from '../templates/modal-film.hbs';\nimport fixObject from './fixObject';\nimport { setLocalStorage, getLocalStorage } from './localStorage';\nimport filmLibraryCard from '../templates/filmLibraryCard.hbs';\nimport setFilmToLocalStorage from './setFilmToLocalStorage';\nimport './theme';\nimport './topBtn';\n\nconst watchedLibraryBtn = document.querySelector('[data-watched]');\nconst queueLibraryBtn = document.querySelector('[data-queue]');\nconst ulEl = document.querySelector('.films');\nconst modalContainer = document.querySelector('#js-film-modal');\n\nconst LOCAL_WATCHED = 'watchedList';\nconst LOCAL_QUEUE = 'queueList';\nconst LOCAL_LIST = 'selectedList';\n\nwatchedLibraryBtn.addEventListener('click', onWatchedLibrary);\nqueueLibraryBtn.addEventListener('click', onQueueLibrary);\nulEl.addEventListener('click', onUlElClick);\n\nconst filmAPIByID = new FilmApi();\n\nfunction onWatchedLibrary() {\n  queueLibraryBtn.classList.remove('is-active');\n  watchedLibraryBtn.classList.add('is-active');\n\n  createFilmList(LOCAL_WATCHED);\n  setLocalStorage(LOCAL_LIST, 'watched');\n}\n\nfunction onQueueLibrary() {\n  watchedLibraryBtn.classList.remove('is-active');\n  queueLibraryBtn.classList.add('is-active');\n\n  createFilmList(LOCAL_QUEUE);\n  setLocalStorage(LOCAL_LIST, 'queue');\n}\n\nasync function onUlElClick(e) {\n  try {\n    if (e.target.nodeName === 'UL') {\n      return;\n    }\n    const selectedList = getLocalStorage(LOCAL_LIST);\n\n    const item = e.target.closest('li');\n\n    let id = item.dataset.id;\n\n    filmAPIByID.idFilm = id;\n    const film = await filmAPIByID.getFilmByID();\n\n    const video = await filmAPIByID.getTrailerById();\n    let arr = video.results;\n    function findTrailer(arr) {\n      return arr\n        .map(el => {\n          return el;\n        })\n        .find(el => el.name === 'Official Trailer');\n    }\n    let objectWithTrailer = findTrailer(arr);\n    const movieLink = `https://www.youtube.com/embed/${objectWithTrailer.key}`;\n\n    const fixedFilm = fixObject(film);\n    fixedFilm.movie = movieLink;\n\n    const filmMarkUp = filmCard(fixedFilm);\n\n    modalContainer.innerHTML = filmMarkUp;\n    modalContainer.classList.remove('is-hidden');\n    let trailerBtnRef = document.querySelector('.trailerShow');\n    let iframeRef = document.querySelector('.hidden');\n    trailerBtnRef.addEventListener('click', () => {\n      iframeRef.classList.toggle('trailer__youtube');\n    });\n\n    let watchedBtn = document.querySelector('[data-name=\"watched\"]');\n    let queueBtn = document.querySelector('[data-name=\"queue\"]');\n    watchedBtn.textContent = 'REMOVE';\n    if (selectedList === 'queue') {\n      queueBtn.textContent = 'ADD TO WATCHED';\n    }\n\n    const onWatchedBtn = event => {\n      if (selectedList === 'watched') {\n        removeFromLocal(LOCAL_WATCHED, id, item);\n      } else {\n        removeFromLocal(LOCAL_QUEUE, id, item);\n      }\n    };\n    const onQueueBtn = event => {\n      if (selectedList === 'queue') {\n        setFilmToLocalStorage(LOCAL_WATCHED, id, fixedFilm);\n        removeFromLocal(LOCAL_QUEUE, id, item);\n      } else {\n        setFilmToLocalStorage(LOCAL_QUEUE, id, fixedFilm);\n        removeFromLocal(LOCAL_WATCHED, id, item);\n      }\n    };\n    modalContainer.addEventListener('click', onModalFilmClick);\n    document.addEventListener('keydown', onClose);\n    watchedBtn.addEventListener('click', onWatchedBtn);\n    queueBtn.addEventListener('click', onQueueBtn);\n  } catch (error) {\n    Notiflix.Notify.failure(error.message);\n  }\n}\n\nfunction removeFromLocal(localKey, filmId, li) {\n  const watchedArray = getLocalStorage(localKey);\n  const index = watchedArray.findIndex(film => film.id === Number(filmId));\n  watchedArray.splice(index, 1);\n  setLocalStorage(localKey, watchedArray);\n  closeModal();\n  li.remove();\n}\n\nfunction createFilmList(localKey) {\n  ulEl.innerHTML = '';\n  const arrayOfWatchedFilms = getLocalStorage(localKey);\n  if (!arrayOfWatchedFilms.length) {\n    Notiflix.Notify.failure('The list is empty.');\n  }\n  const watchedMarkUp = arrayOfWatchedFilms\n    .map(film => filmLibraryCard(film))\n    .join('');\n  ulEl.insertAdjacentHTML('beforeend', watchedMarkUp);\n}\nfunction closeModal() {\n  modalContainer.innerHTML = '';\n  modalContainer.classList.add('is-hidden');\n  document.removeEventListener('keydown', onClose);\n  modalContainer.removeEventListener('click', onModalFilmClick);\n}\nfunction onClose(event) {\n  if (event.code === 'Escape') {\n    closeModal();\n  }\n}\nfunction onModalFilmClick(event) {\n  if (event.target.nodeName === 'path' || event.target.nodeName === 'svg') {\n    closeModal();\n  }\n  if (event.target === event.currentTarget) {\n    closeModal();\n  }\n}\n","<li class='films__item' data-id={{id}}>\n    <div class='films__img'>\n        <img src='https://image.tmdb.org/t/p/w500{{poster_path}}' alt={{original_title}} loading='lazy' />\n    </div>\n    <div class='films__description'>\n        <p class='films__name'>{{title}}</p>\n        <div class=\"films__container\">\n            <p class='films__info'>{{genres}} | {{release_date}}</p>\n            <span class='films__rating'>{{vote_average}}</span>\n        </div>      \n    </div>\n</li>"],"names":["$bpxeT","parcelRequire","$l5bVx","$2523f6b7b77ece1d$export$2e2bcd8739ae039","$parcel$interopDefault","template","compiler","main","container","depth0","helpers","partials","data","helper","alias1","nullContext","alias2","hooks","helperMissing","alias3","alias4","escapeExpression","lookupProperty","parent","propertyName","Object","prototype","hasOwnProperty","call","name","hash","loc","start","line","column","end","useData","$93effc6fc56091ad$var$watchedLibraryBtn","document","querySelector","$93effc6fc56091ad$var$queueLibraryBtn","$93effc6fc56091ad$var$ulEl","$93effc6fc56091ad$var$modalContainer","$93effc6fc56091ad$var$LOCAL_WATCHED","$93effc6fc56091ad$var$LOCAL_QUEUE","$93effc6fc56091ad$var$LOCAL_LIST","addEventListener","classList","remove","add","$93effc6fc56091ad$var$createFilmList","$UL92Z","setLocalStorage","e","$93effc6fc56091ad$var$_onUlElClick","apply","this","arguments","$93effc6fc56091ad$var$filmAPIByID","$lHIzZ","default","$2TvXO","mark","_callee","selectedList","item","id","film","video","arr1","findTrailer","objectWithTrailer","movieLink","fixedFilm","filmMarkUp","trailerBtnRef","iframeRef","watchedBtn","queueBtn","onWatchedBtn","onQueueBtn","arr","map","el","find","target","nodeName","getLocalStorage","closest","dataset","idFilm","getFilmByID","_ctx","sent","getTrailerById","results","concat","key","$pWSgs","movie","$2eIIo","innerHTML","toggle","textContent","event","$93effc6fc56091ad$var$removeFromLocal","$bGg9a","$93effc6fc56091ad$var$onModalFilmClick","$93effc6fc56091ad$var$onClose","$iU1Pc","Notify","failure","t0","message","localKey","filmId","li","watchedArray","index","findIndex","Number","splice","$93effc6fc56091ad$var$closeModal","arrayOfWatchedFilms","length","watchedMarkUp","join","insertAdjacentHTML","removeEventListener","code","currentTarget"],"version":3,"file":"library.6f3f7b62.js.map"}