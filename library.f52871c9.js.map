{"mappings":"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","sources":["src/js/library.js","src/templates/filmLibraryCard.hbs","src/js/getFavGenres.js"],"sourcesContent":["import Notiflix from 'notiflix';\nimport FilmApi from './movieAPI';\nimport filmCard from '../templates/modal-film.hbs';\nimport fixObject from './fixObject';\nimport { setLocalStorage, getLocalStorage } from './localStorage';\nimport filmLibraryCard from '../templates/filmLibraryCard.hbs';\nimport setFilmToLocalStorage from './setFilmToLocalStorage';\nimport { getFavGenres } from './getFavGenres';\nimport { spinnerPlay, spinnerStop } from './spinner.js';\nimport fixArray from './fixArray';\nimport { createPagination } from './pagination';\nimport { createMarkUp } from './createMarkUp';\nimport './theme';\nimport './topBtn';\n\nconst watchedLibraryBtn = document.querySelector('[data-watched]');\nconst queueLibraryBtn = document.querySelector('[data-queue]');\nconst favBtn = document.querySelector('[data-fav]');\nconst h2Rec = document.querySelector('.recom');\n\nconst ulEl = document.querySelector('.films');\nconst modalContainer = document.querySelector('#js-film-modal');\n\nconst LOCAL_WATCHED = 'watchedList';\nconst LOCAL_QUEUE = 'queueList';\nconst LOCAL_LIST = 'selectedList';\n\nwatchedLibraryBtn.addEventListener('click', onWatchedLibrary);\nqueueLibraryBtn.addEventListener('click', onQueueLibrary);\nfavBtn.addEventListener('click', onFavBtn);\nulEl.addEventListener('click', onUlElClick);\n\nconst filmAPIByID = new FilmApi();\n\nfunction onWatchedLibrary() {\n  queueLibraryBtn.classList.remove('is-active');\n  favBtn.classList.remove('is-active');\n  watchedLibraryBtn.classList.add('is-active');\n  if (!h2Rec.classList.contains('visually-hidden'))\n    h2Rec.classList.add('visually-hidden');\n  createFilmList(LOCAL_WATCHED);\n  setLocalStorage(LOCAL_LIST, 'watched');\n}\n\nfunction onQueueLibrary() {\n  watchedLibraryBtn.classList.remove('is-active');\n  favBtn.classList.remove('is-active');\n  queueLibraryBtn.classList.add('is-active');\n  if (!h2Rec.classList.contains('visually-hidden'))\n    h2Rec.classList.add('visually-hidden');\n  createFilmList(LOCAL_QUEUE);\n  setLocalStorage(LOCAL_LIST, 'queue');\n}\nasync function onFavBtn() {\n  try {\n    setLocalStorage(LOCAL_LIST, 'fav');\n    ulEl.innerHTML = '';\n    watchedLibraryBtn.classList.remove('is-active');\n    queueLibraryBtn.classList.remove('is-active');\n    favBtn.classList.add('is-active');\n    const favGenres = getFavGenres();\n    if (!favGenres.length) {\n      Notiflix.Notify.failure(\"We don't have any recomendations for you :(\");\n      return;\n    }\n    h2Rec.classList.remove('visually-hidden');\n\n    spinnerPlay();\n\n    const { results, total_results } = await filmAPIByID.getFavMovies(\n      favGenres\n    );\n    const correctFilmsList = await fixArray(results);\n    const markUp = createMarkUp(correctFilmsList);\n    ulEl.insertAdjacentHTML('beforeend', markUp);\n  } catch (error) {\n    Notiflix.Notify.failure(error.message);\n  } finally {\n    spinnerStop();\n  }\n}\n\nasync function onUlElClick(e) {\n  try {\n    if (e.target.nodeName === 'UL') {\n      return;\n    }\n    const selectedList = getLocalStorage(LOCAL_LIST);\n\n    const item = e.target.closest('li');\n\n    let id = item.dataset.id;\n\n    filmAPIByID.idFilm = id;\n    const film = await filmAPIByID.getFilmByID();\n\n    const video = await filmAPIByID.getTrailerById();\n\n    let arr = video.results;\n\n    function findTrailer(arr) {\n      return arr\n        .map(el => {\n          return el;\n        })\n        .find(el => el.name.includes('Trailer') || el.name);\n    }\n    let objectWithTrailer = findTrailer(arr);\n\n    function trailerCheck(object) {\n      if (!object) {\n        Notiflix.Notify.failure('Oops! Trailer did not find...');\n      } else {\n        return `https://www.youtube.com/embed/${object.key}`;\n      }\n    }\n    const movieLink = trailerCheck(objectWithTrailer);\n\n    const fixedFilm = fixObject(film);\n\n    fixedFilm.movie = movieLink;\n\n    const filmMarkUp = filmCard(fixedFilm);\n\n    modalContainer.innerHTML = filmMarkUp;\n    modalContainer.classList.remove('is-hidden');\n    let trailerBtnRef = document.querySelector('.trailerShow');\n    let iframeRef = document.querySelector('.hidden');\n    trailerBtnRef.addEventListener('click', toggleIframe);\n\n    function disabledtrailerBtn() {\n      if (!fixedFilm.movie) {\n        trailerBtnRef.disabled = true;\n      }\n    }\n    disabledtrailerBtn();\n    function toggleIframe() {\n      iframeRef.classList.toggle('trailer__youtube');\n    }\n\n    let watchedBtn = document.querySelector('[data-name=\"watched\"]');\n    let queueBtn = document.querySelector('[data-name=\"queue\"]');\n    watchedBtn.textContent = 'REMOVE';\n    if (selectedList === 'queue') {\n      queueBtn.textContent = 'ADD TO WATCHED';\n    }\n\n    const onWatchedBtn = event => {\n      if (selectedList === 'watched') {\n        removeFromLocal(LOCAL_WATCHED, id, item);\n      } else {\n        removeFromLocal(LOCAL_QUEUE, id, item);\n      }\n    };\n    const onQueueBtn = event => {\n      if (selectedList === 'queue') {\n        setFilmToLocalStorage(LOCAL_WATCHED, id, fixedFilm);\n        removeFromLocal(LOCAL_QUEUE, id, item);\n      } else {\n        setFilmToLocalStorage(LOCAL_QUEUE, id, fixedFilm);\n        removeFromLocal(LOCAL_WATCHED, id, item);\n      }\n    };\n    modalContainer.addEventListener('click', onModalFilmClick);\n    document.addEventListener('keydown', onClose);\n    watchedBtn.addEventListener('click', onWatchedBtn);\n    queueBtn.addEventListener('click', onQueueBtn);\n  } catch (error) {\n    Notiflix.Notify.failure(error.message);\n  }\n}\n\nfunction removeFromLocal(localKey, filmId, li) {\n  const watchedArray = getLocalStorage(localKey);\n  const index = watchedArray.findIndex(film => film.id === Number(filmId));\n  watchedArray.splice(index, 1);\n  setLocalStorage(localKey, watchedArray);\n  closeModal();\n  li.remove();\n}\n\nfunction createFilmList(localKey) {\n  ulEl.innerHTML = '';\n  const arrayOfWatchedFilms = getLocalStorage(localKey);\n  if (!arrayOfWatchedFilms.length) {\n    Notiflix.Notify.failure('The list is empty.');\n  }\n  const watchedMarkUp = arrayOfWatchedFilms\n    .map(film => filmLibraryCard(film))\n    .join('');\n  ulEl.insertAdjacentHTML('beforeend', watchedMarkUp);\n}\n\nfunction closeModal() {\n  modalContainer.innerHTML = '';\n  modalContainer.classList.add('is-hidden');\n  document.removeEventListener('keydown', onClose);\n  modalContainer.removeEventListener('click', onModalFilmClick);\n}\n\nfunction onClose(event) {\n  if (event.code === 'Escape') {\n    closeModal();\n  }\n}\n\nfunction onModalFilmClick(event) {\n  if (event.target.nodeName === 'path' || event.target.nodeName === 'svg') {\n    closeModal();\n  }\n  if (event.target === event.currentTarget) {\n    closeModal();\n  }\n}\n","<li class='films__item' data-id={{id}}>\n    <div class='films__img'>\n        <img src='https://image.tmdb.org/t/p/w500{{poster_path}}' alt={{original_title}} loading='lazy' />\n    </div>\n    <div class='films__description'>\n        <p class='films__name'>{{title}}</p>\n        <div class=\"films__container\">\n            <p class='films__info'>{{genres}} | {{release_date}}</p>\n            <span class='films__rating'>{{vote_average}}</span>\n        </div>      \n    </div>\n</li>","import { setLocalStorage, getLocalStorage } from './localStorage';\nconst FAV_KEY = 'favouriteMovies';\nconst favLocal = getLocalStorage(FAV_KEY);\nconst arrayOfValues = Object.values(favLocal);\nexport function getFavGenres() {\n  const object = {};\n\n  arrayOfValues.forEach(film => {\n    if (object[film.id]) {\n      object[film.id] = object[film.id] + 1;\n    } else {\n      object[film.id] = 1;\n    }\n  });\n  const sortedGenres = Object.entries(object).sort((a, b) => b[1] - a[1]);\n  const favGenres = [];\n  sortedGenres.forEach(genre => favGenres.push(Number(genre[0])));\n  return favGenres.slice(0, 3).join(', ');\n}\n"],"names":["$eWCmQ","parcelRequire","$9fc7fd4e44c7ad3b$export$2e2bcd8739ae039","$parcel$interopDefault","template","compiler","main","container","depth0","helpers","partials","data","helper","alias1","nullContext","alias2","hooks","helperMissing","alias3","alias4","escapeExpression","lookupProperty","parent","propertyName","Object","prototype","hasOwnProperty","call","name","hash","loc","start","line","column","end","useData","$13658437a27d00f2$var$favLocal","$31u3U","getLocalStorage","$13658437a27d00f2$var$arrayOfValues","values","$13658437a27d00f2$export$951d08e861c72846","object","forEach","film","id","sortedGenres","entries","sort","a","b","favGenres","genre","push","Number","slice","join","$1cafa503bc57b7a0$var$watchedLibraryBtn","document","querySelector","$1cafa503bc57b7a0$var$queueLibraryBtn","$1cafa503bc57b7a0$var$favBtn","$1cafa503bc57b7a0$var$h2Rec","$1cafa503bc57b7a0$var$ulEl","$1cafa503bc57b7a0$var$modalContainer","addEventListener","classList","remove","add","contains","$1cafa503bc57b7a0$var$createFilmList","setLocalStorage","async","innerHTML","length","Notify","failure","$04jNI","spinnerPlay","results","total_results","$1cafa503bc57b7a0$var$filmAPIByID","getFavMovies","correctFilmsList","$hfgIj","default","markUp","$1vg23","createMarkUp","insertAdjacentHTML","error","message","spinnerStop","e","target","nodeName","selectedList","item","closest","dataset","idFilm","getFilmByID","arr1","getTrailerById","movieLink","key","trailerCheck","map","el","find","includes","fixedFilm","$6Jpgb","movie","filmMarkUp","$eXQeU","trailerBtnRef","iframeRef","toggle","disabled","watchedBtn","queueBtn","textContent","onWatchedBtn","event","$1cafa503bc57b7a0$var$removeFromLocal","onQueueBtn","$2ST4D","$1cafa503bc57b7a0$var$onModalFilmClick","$1cafa503bc57b7a0$var$onClose","$9Bkxl","localKey","filmId","li","watchedArray","index","findIndex","splice","$1cafa503bc57b7a0$var$closeModal","arrayOfWatchedFilms","watchedMarkUp","removeEventListener","code","currentTarget"],"version":3,"file":"library.f52871c9.js.map"}